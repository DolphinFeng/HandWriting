import { schemaMigration } from '../schemaMigration';

describe('schema 升级测试', () => {
  describe('2.0.1 测试', () => {
    /**
     * 2.0.1 将layout 从 vertical 升级到 horizontal
     *  */

    test('测试 vertical 到 horizontal 转化', () => {
      const schemaString =
        '{"schemaVersion":"2.0.0","schemaType":"积木低代码schema协议","pages":[{"id":"FORM-F1866AD13MZIV0J81FX0F72MEQWJ2SNNBHMEKA","layout":{"id":"jimuroot_53411b09","componentName":"JimuRoot","props":{"fieldId":"jimuroot_53411b09"},"children":[{"id":"card_a2861abe","componentName":"Card","props":{"title":"全表单分组1","layoutPC":"VERTICAL","layoutMOBILE":"HORIZONTAL","fieldId":"card_a2861abe"},"children":[{"id":"input_d9ae4dc2","componentName":"Input","props":{"label":"单行文本输入","layout":"VERTICAL","showLabel":true,"placeholder":"输入文本","validation":[{"type":"required","value":true,"message":"","param":"","text":"必填"}],"fieldId":"input_d9ae4dc2","highlight":false,"visibility":true,"styleMaxWidth":{"value":450},"required":true},"children":[],"parentInstanceKey":"card_a2861abe"},{"id":"number_9cc1e62c","componentName":"Number","props":{"label":"数字输入框","layout":"VERTICAL","showLabel":true,"placeholder":"输入数字","validation":[{"type":"required","value":true,"message":"","param":"","text":"必填"}],"fieldId":"number_9cc1e62c","highlight":false,"visibility":true,"styleMaxWidth":{"value":450},"required":true},"children":[],"parentInstanceKey":"card_a2861abe"},{"id":"textarea_6d8ade79","componentName":"TextArea","props":{"label":"多行文本输入","layout":"VERTICAL","showLabel":true,"placeholder":"请输入文本","validation":[{"type":"required","value":true,"message":"","param":"","text":"必填"}],"fieldId":"textarea_6d8ade79","highlight":false,"visibility":true,"styleMaxWidth":{"value":"100%"},"required":true},"children":[],"parentInstanceKey":"card_a2861abe"},{"id":"select_7635fea1","componentName":"Select","props":{"label":"单选框","layout":"VERTICAL","showLabel":true,"placeholder":"请选择","options":[{"value":"select0telxo3cywd8","label":"111"},{"value":"select0ezfcuy3tb1e","label":"222"}],"validation":[{"type":"required","value":true,"message":"","param":"","text":"必填"}],"fieldId":"select_7635fea1","visibility":true,"styleMaxWidth":{"value":450},"required":true},"children":[],"parentInstanceKey":"card_a2861abe"},{"id":"captions_e8edc615","componentName":"Captions","props":{"label":"说明文字1","content":"请输入说明文字","link":"","highlight":"normal","visibility":true,"fieldId":"captions_e8edc615","styleMaxWidth":{"value":"100%"}},"children":[],"parentInstanceKey":"card_a2861abe"},{"id":"selectdd_2ff1b57b","componentName":"SelectDD","props":{"label":"多选框","layout":"VERTICAL","showLabel":true,"placeholder":"请选择","options":[{"value":"selectdd0ousgz2kkx5","label":"111"},{"value":"selectdd03gz88glbolj","label":"222"},{"value":"selectdd02f3fo2k0pfb","label":"333"}],"validation":[{"type":"required","value":true,"message":"","param":"","text":"必填"}],"visibility":true,"fieldId":"selectdd_2ff1b57b","styleMaxWidth":{"value":450},"required":true},"children":[],"parentInstanceKey":"card_a2861abe"},{"id":"daterange_f449211d","componentName":"DateRange","props":{"label":"日期区间","layout":"VERTICAL","showLabel":true,"label2":"结束时间","dateType":"YYYY-MM-DD","validation":[{"type":"required","value":true,"message":"","param":"","text":"必填"}],"fieldId":"daterange_f449211d","visibility":true,"styleMaxWidth":{"value":450},"required":true},"children":[],"parentInstanceKey":"card_a2861abe"},{"id":"date_db50d925","componentName":"Date","props":{"label":"日期选择","layout":"VERTICAL","showLabel":true,"dateType":"YYYY-MM-DD","validation":[{"type":"required","value":true,"message":"","param":"","text":"必填"}],"fieldId":"date_db50d925","visibility":true,"styleMaxWidth":{"value":450},"required":true},"children":[],"parentInstanceKey":"card_a2861abe"},{"id":"money_310203eb","componentName":"Money","props":{"label":"金额","layout":"VERTICAL","showLabel":true,"placeholder":"输入金额","validation":[{"type":"required","value":true,"message":"","param":"","text":"必填"}],"fieldId":"money_310203eb","highlight":false,"visibility":true,"styleMaxWidth":{"value":450},"required":true},"children":[],"parentInstanceKey":"card_a2861abe"}],"parentInstanceKey":"jimuroot_53411b09"},{"id":"card_f2845a0a","componentName":"Card","props":{"title":"分组2","layoutPC":"VERTICAL","layoutMOBILE":"HORIZONTAL","fieldId":"card_f2845a0a"},"children":[{"id":"file_99c572fd","componentName":"File","props":{"label":"附件","layout":"VERTICAL","showLabel":true,"validation":[{"type":"required","value":true,"message":"","param":"","text":"必填"}],"fieldId":"file_99c572fd","visibility":true,"styleMaxWidth":{"value":"100%"},"required":true},"children":[],"parentInstanceKey":"card_f2845a0a"},{"id":"department_4f1295fd","componentName":"Department","props":{"label":"部门","layout":"VERTICAL","showLabel":true,"placeholder":"请输入完整的部门节点名称","validation":[{"type":"required","value":true,"message":"","param":"","text":"必填"}],"fieldId":"department_4f1295fd","highlight":false,"visibility":true,"styleMaxWidth":{"value":450},"required":true},"children":[],"parentInstanceKey":"card_f2845a0a"},{"id":"people_cde91c57","componentName":"People","props":{"label":"人员","layout":"VERTICAL","showLabel":true,"placeholder":"请输入人员姓名/mis号","validation":[{"type":"required","value":true,"message":"","param":"","text":"必填"}],"fieldId":"people_cde91c57","highlight":false,"visibility":true,"styleMaxWidth":{"value":450},"required":true},"children":[],"parentInstanceKey":"card_f2845a0a"},{"id":"columnsgrid_395fe974","componentName":"ColumnsGrid","props":{"layout":"12:12","visibility":true,"fieldId":"columnsgrid_395fe974"},"children":[{"id":"column_acd4fd38","componentName":"Column","props":{"fieldId":"column_acd4fd38"},"children":[{"id":"number_2ac5b1b1","componentName":"Number","props":{"label":"分组+分栏+数字","layout":"VERTICAL","showLabel":true,"placeholder":"输入数字","validation":[{"type":"required","value":true,"message":"","param":"","text":"必填"}],"fieldId":"number_2ac5b1b1","highlight":false,"visibility":true,"styleMaxWidth":{"value":450},"required":true},"children":[],"parentInstanceKey":"column_acd4fd38"}],"parentInstanceKey":"columnsgrid_395fe974"},{"id":"column_eeebc8e5","componentName":"Column","props":{"fieldId":"column_eeebc8e5"},"children":[{"id":"number_4b347afe","componentName":"Number","props":{"label":"分组+分栏+数字2","layout":"VERTICAL","showLabel":true,"placeholder":"输入数字","validation":[{"type":"required","value":true,"message":"","param":"","text":"必填"}],"fieldId":"number_4b347afe","highlight":false,"visibility":true,"styleMaxWidth":{"value":450},"required":true},"children":[],"parentInstanceKey":"column_eeebc8e5"}],"parentInstanceKey":"columnsgrid_395fe974"}],"parentInstanceKey":"card_f2845a0a"},{"id":"image_acc021e6","componentName":"Image","props":{"label":"图片","layout":"VERTICAL","showLabel":true,"validation":[{"type":"required","value":true,"message":"","param":"","text":"必填"}],"fieldId":"image_acc021e6","visibility":true,"styleMaxWidth":{"value":"100%"},"required":true},"children":[],"parentInstanceKey":"card_f2845a0a"}],"parentInstanceKey":"jimuroot_53411b09"},{"id":"people_ad85c8c8","componentName":"People","props":{"label":"人员2","layout":"VERTICAL","showLabel":true,"placeholder":"请输入人员姓名/mis号","validation":[{"type":"required","value":true,"message":"","param":"","text":"必填"}],"fieldId":"people_ad85c8c8","highlight":false,"visibility":true,"styleMaxWidth":{"value":450},"required":true},"children":[],"parentInstanceKey":"jimuroot_53411b09"},{"id":"department_b6f837ed","componentName":"Department","props":{"label":"部门3","layout":"VERTICAL","showLabel":true,"placeholder":"请输入完整的部门节点名称","validation":[{"type":"required","value":true,"message":"","param":"","text":"必填"}],"fieldId":"department_b6f837ed","highlight":false,"visibility":true,"styleMaxWidth":{"value":450},"required":true},"children":[],"parentInstanceKey":"jimuroot_53411b09"}],"parentInstanceKey":null},"dataSource":{"online":[]}}],"action":{"source":"\\n/**\\n  * 私有的，可复用的函数\\n  * 函数面板帮助文档: \\n  * @see \\n  */\\nexport function helloWorld(obj) {\\n  console.info(obj);\\n}","type":"FUNCTION","list":[{"id":"helloWorld","title":"helloWorld"}]}}';
      expect(schemaMigration(schemaString)).toBe(
        '{"schemaVersion":"2.0.0","schemaType":"积木低代码schema协议","pages":[{"id":"FORM-F1866AD13MZIV0J81FX0F72MEQWJ2SNNBHMEKA","layout":{"id":"jimuroot_53411b09","componentName":"JimuRoot","props":{"fieldId":"jimuroot_53411b09"},"children":[{"id":"card_a2861abe","componentName":"Card","props":{"title":"全表单分组1","fieldId":"card_a2861abe"},"children":[{"id":"input_d9ae4dc2","componentName":"Input","props":{"label":"单行文本输入","layout":"HORIZONTAL","showLabel":true,"placeholder":"输入文本","validation":[{"type":"required","value":true,"message":"","param":"","text":"必填"}],"fieldId":"input_d9ae4dc2","highlight":false,"visibility":true,"styleMaxWidth":{"value":450},"required":true},"children":[],"parentInstanceKey":"card_a2861abe"},{"id":"number_9cc1e62c","componentName":"Number","props":{"label":"数字输入框","layout":"HORIZONTAL","showLabel":true,"placeholder":"输入数字","validation":[{"type":"required","value":true,"message":"","param":"","text":"必填"}],"fieldId":"number_9cc1e62c","highlight":false,"visibility":true,"styleMaxWidth":{"value":450},"required":true},"children":[],"parentInstanceKey":"card_a2861abe"},{"id":"textarea_6d8ade79","componentName":"TextArea","props":{"label":"多行文本输入","layout":"HORIZONTAL","showLabel":true,"placeholder":"请输入文本","validation":[{"type":"required","value":true,"message":"","param":"","text":"必填"}],"fieldId":"textarea_6d8ade79","highlight":false,"visibility":true,"styleMaxWidth":{"value":"100%"},"required":true},"children":[],"parentInstanceKey":"card_a2861abe"},{"id":"select_7635fea1","componentName":"Select","props":{"label":"单选框","layout":"HORIZONTAL","showLabel":true,"placeholder":"请选择","options":[{"value":"select0telxo3cywd8","label":"111"},{"value":"select0ezfcuy3tb1e","label":"222"}],"validation":[{"type":"required","value":true,"message":"","param":"","text":"必填"}],"fieldId":"select_7635fea1","visibility":true,"styleMaxWidth":{"value":450},"required":true},"children":[],"parentInstanceKey":"card_a2861abe"},{"id":"captions_e8edc615","componentName":"Captions","props":{"label":"说明文字1","content":"请输入说明文字","link":"","highlight":"normal","visibility":true,"fieldId":"captions_e8edc615","styleMaxWidth":{"value":"100%"}},"children":[],"parentInstanceKey":"card_a2861abe"},{"id":"selectdd_2ff1b57b","componentName":"SelectDD","props":{"label":"多选框","layout":"HORIZONTAL","showLabel":true,"placeholder":"请选择","options":[{"value":"selectdd0ousgz2kkx5","label":"111"},{"value":"selectdd03gz88glbolj","label":"222"},{"value":"selectdd02f3fo2k0pfb","label":"333"}],"validation":[{"type":"required","value":true,"message":"","param":"","text":"必填"}],"visibility":true,"fieldId":"selectdd_2ff1b57b","styleMaxWidth":{"value":450},"required":true},"children":[],"parentInstanceKey":"card_a2861abe"},{"id":"daterange_f449211d","componentName":"DateRange","props":{"label":"日期区间","layout":"HORIZONTAL","showLabel":true,"label2":"结束时间","dateType":"YYYY-MM-DD","validation":[{"type":"required","value":true,"message":"","param":"","text":"必填"}],"fieldId":"daterange_f449211d","visibility":true,"styleMaxWidth":{"value":450},"required":true},"children":[],"parentInstanceKey":"card_a2861abe"},{"id":"date_db50d925","componentName":"Date","props":{"label":"日期选择","layout":"HORIZONTAL","showLabel":true,"dateType":"YYYY-MM-DD","validation":[{"type":"required","value":true,"message":"","param":"","text":"必填"}],"fieldId":"date_db50d925","visibility":true,"styleMaxWidth":{"value":450},"required":true},"children":[],"parentInstanceKey":"card_a2861abe"},{"id":"money_310203eb","componentName":"Money","props":{"label":"金额","layout":"HORIZONTAL","showLabel":true,"placeholder":"输入金额","validation":[{"type":"required","value":true,"message":"","param":"","text":"必填"}],"fieldId":"money_310203eb","highlight":false,"visibility":true,"styleMaxWidth":{"value":450},"required":true},"children":[],"parentInstanceKey":"card_a2861abe"}],"parentInstanceKey":"jimuroot_53411b09"},{"id":"card_f2845a0a","componentName":"Card","props":{"title":"分组2","fieldId":"card_f2845a0a"},"children":[{"id":"file_99c572fd","componentName":"File","props":{"label":"附件","layout":"HORIZONTAL","showLabel":true,"validation":[{"type":"required","value":true,"message":"","param":"","text":"必填"}],"fieldId":"file_99c572fd","visibility":true,"styleMaxWidth":{"value":"100%"},"required":true},"children":[],"parentInstanceKey":"card_f2845a0a"},{"id":"department_4f1295fd","componentName":"Department","props":{"label":"部门","layout":"HORIZONTAL","showLabel":true,"placeholder":"请输入完整的部门节点名称","validation":[{"type":"required","value":true,"message":"","param":"","text":"必填"}],"fieldId":"department_4f1295fd","highlight":false,"visibility":true,"styleMaxWidth":{"value":450},"required":true},"children":[],"parentInstanceKey":"card_f2845a0a"},{"id":"people_cde91c57","componentName":"People","props":{"label":"人员","layout":"HORIZONTAL","showLabel":true,"placeholder":"请输入人员姓名/mis号","validation":[{"type":"required","value":true,"message":"","param":"","text":"必填"}],"fieldId":"people_cde91c57","highlight":false,"visibility":true,"styleMaxWidth":{"value":450},"required":true},"children":[],"parentInstanceKey":"card_f2845a0a"},{"id":"columnsgrid_395fe974","componentName":"ColumnsGrid","props":{"layout":"12:12","visibility":true,"fieldId":"columnsgrid_395fe974"},"children":[{"id":"column_acd4fd38","componentName":"Column","props":{"fieldId":"column_acd4fd38"},"children":[{"id":"number_2ac5b1b1","componentName":"Number","props":{"label":"分组+分栏+数字","layout":"HORIZONTAL","showLabel":true,"placeholder":"输入数字","validation":[{"type":"required","value":true,"message":"","param":"","text":"必填"}],"fieldId":"number_2ac5b1b1","highlight":false,"visibility":true,"styleMaxWidth":{"value":450},"required":true},"children":[],"parentInstanceKey":"column_acd4fd38"}],"parentInstanceKey":"columnsgrid_395fe974"},{"id":"column_eeebc8e5","componentName":"Column","props":{"fieldId":"column_eeebc8e5"},"children":[{"id":"number_4b347afe","componentName":"Number","props":{"label":"分组+分栏+数字2","layout":"HORIZONTAL","showLabel":true,"placeholder":"输入数字","validation":[{"type":"required","value":true,"message":"","param":"","text":"必填"}],"fieldId":"number_4b347afe","highlight":false,"visibility":true,"styleMaxWidth":{"value":450},"required":true},"children":[],"parentInstanceKey":"column_eeebc8e5"}],"parentInstanceKey":"columnsgrid_395fe974"}],"parentInstanceKey":"card_f2845a0a"},{"id":"image_acc021e6","componentName":"Image","props":{"label":"图片","layout":"HORIZONTAL","showLabel":true,"validation":[{"type":"required","value":true,"message":"","param":"","text":"必填"}],"fieldId":"image_acc021e6","visibility":true,"styleMaxWidth":{"value":"100%"},"required":true},"children":[],"parentInstanceKey":"card_f2845a0a"}],"parentInstanceKey":"jimuroot_53411b09"},{"id":"people_ad85c8c8","componentName":"People","props":{"label":"人员2","layout":"HORIZONTAL","showLabel":true,"placeholder":"请输入人员姓名/mis号","validation":[{"type":"required","value":true,"message":"","param":"","text":"必填"}],"fieldId":"people_ad85c8c8","highlight":false,"visibility":true,"styleMaxWidth":{"value":450},"required":true},"children":[],"parentInstanceKey":"jimuroot_53411b09"},{"id":"department_b6f837ed","componentName":"Department","props":{"label":"部门3","layout":"HORIZONTAL","showLabel":true,"placeholder":"请输入完整的部门节点名称","validation":[{"type":"required","value":true,"message":"","param":"","text":"必填"}],"fieldId":"department_b6f837ed","highlight":false,"visibility":true,"styleMaxWidth":{"value":450},"required":true},"children":[],"parentInstanceKey":"jimuroot_53411b09"}],"parentInstanceKey":null},"dataSource":{"online":[]}}],"action":{"source":"\\n/**\\n  * 私有的，可复用的函数\\n  * 函数面板帮助文档: \\n  * @see \\n  */\\nexport function helloWorld(obj) {\\n  console.info(obj);\\n}","type":"FUNCTION","list":[{"id":"helloWorld","title":"helloWorld"}]}}'
      );
    });
  });
});
